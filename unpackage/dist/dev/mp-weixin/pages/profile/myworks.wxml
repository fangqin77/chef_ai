<view class="page"><block wx:if="{{!$root.g0}}"><view class="empty"><text class="tip">还没有发布作品</text><button data-event-opts="{{[['tap',[['goPublish',['$event']]]]]}}" class="btn primary small" bindtap="__e">去发布</button></view></block><block wx:else><scroll-view class="list" scroll-y="{{true}}"><block wx:for="{{posts}}" wx:for-item="p" wx:for-index="__i0__" wx:key="id"><view class="card"><view class="top"><image class="cover" src="{{p.images&&p.images[0]||fallbackImg}}" mode="aspectFill"></image><view class="meta"><text class="name">{{p.name||p.text||''}}</text><text class="time">{{p.time||'刚刚'}}</text></view><view class="ops"><block wx:if="{{!p._editing}}"><button data-event-opts="{{[['tap',[['editPost',['$0'],[[['posts','id',p.id]]]]]]]}}" class="btn tiny ghost" bindtap="__e">编辑</button></block><button data-event-opts="{{[['tap',[['deletePost',['$0'],[[['posts','id',p.id]]]]]]]}}" class="btn tiny danger" bindtap="__e">删除</button></view></view><block wx:if="{{!p._editing}}"><view class="content">{{p.text}}</view></block><block wx:else><view class="edit-panel"><view class="row"><text class="label">标题</text><input class="input" placeholder="请输入标题（选填）" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],[[['posts','id',p.id,'_editForm']]]]]]]}}" value="{{p._editForm.name}}" bindinput="__e"/></view><view class="row"><text class="label">文案</text><textarea class="textarea" placeholder="编辑你的文案" maxlength="200" data-event-opts="{{[['input',[['__set_model',['$0','text','$event',[]],[[['posts','id',p.id,'_editForm']]]]]]]}}" value="{{p._editForm.text}}" bindinput="__e"></textarea></view><view class="edit-ops"><button data-event-opts="{{[['tap',[['saveEdit',['$0'],[[['posts','id',p.id]]]]]]]}}" class="btn tiny primary" bindtap="__e">保存</button><button data-event-opts="{{[['tap',[['cancelEdit',['$0'],[[['posts','id',p.id]]]]]]]}}" class="btn tiny ghost" bindtap="__e">取消</button></view><text class="hint">文字限制 200 字</text></view></block></view></block></scroll-view></block></view>